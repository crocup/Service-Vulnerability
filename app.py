from flask import Flask, jsonify, request, abort
import config
from rq import Queue

from vulnerability import result_code, VulnDB
from worker import conn

app = Flask(__name__)
app.config.from_object(config.DevelopmentConfig)
q = Queue(name='vulnerability', connection=conn)


@app.route('/api/v1/vulnerability/cve', methods=['POST'])
def message_cve():
    if not request.json:
        abort(400)
    data = request.json
    result_code(VulnDB(), product=data["product"], version=data["version"])
    return jsonify({"result": "OK"})


@app.route('/api/v1/vulnerability/exploit', methods=['POST'])
def message_exploit():
    if not request.json:
        abort(400)
    pass
    return jsonify({"result": "OK"})


@app.route('/api/v1/vulnerability/bruteforce', methods=['POST'])
def message_bruteforce():
    if not request.json:
        abort(400)
    pass
    return jsonify({"result": "OK"})


if __name__ == '__main__':
    app.run(port=9010)
